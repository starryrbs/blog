(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{269:function(e,n,t){"use strict";t.r(n);var a=t(2),l=Object(a.a)({},function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("blockquote",[t("p",[e._v("状态模式是行为型模式")])]),e._v(" "),t("h2",{attrs:{id:"使用-python-实现"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用-python-实现","aria-hidden":"true"}},[e._v("#")]),e._v(" 使用 Python 实现")]),e._v(" "),t("p",[e._v("python 的代码采用的是“面向对象”的编程，没有过度使用函数式的闭包写法（python 写起来也不难）。")]),e._v(" "),t("p",[e._v("因此，负责状态转化的类，专门拿出来单独封装。 其他 3 个状态类的状态，均由这个状态类来管理。")]),e._v(" "),t("pre",[t("code",[e._v("class StateTransform:\n    def __init__(self):\n        self.__state = 'download'\n        self.states = ['download', 'pause', 'handle_delete']\n\n    def change(self, state):\n        if (not state) and state not in self.states:\n            raise Exception('state is valid')\n        self.__state = state\n\n    def get_state(self):\n        return self.__state\n\n\nclass DownloadState:\n    def __init__(self, transformer):\n        self.__state = 'download'\n        self.__transformer = transformer\n\n    def click(self):\n        print(\"暂停下载\")\n        self.__transformer.change('pause')\n\n    def delete(self):\n        print('请先暂停，再删除')\n\n\nclass PauseState:\n    def __init__(self, transformer):\n        self.__state = 'pause'\n        self.__transformer = transformer\n\n    def click(self):\n        print('继续下载')\n        self.__transformer.change('download')\n\n    def delete(self):\n        print('删除成功')\n        self.__transformer.change('handle_delete')\n\n\nclass DeleteState:\n    def __init__(self, transformer):\n        self.__state = 'handle_delete'\n        self.__transformer = transformer\n\n    def click(self):\n        print('任务已经被删除了，点击无效')\n\n    def delete(self):\n        print('任务不存在')\n\n\nclass Download:\n    def __init__(self):\n        self.transformer = StateTransform()\n        self.state_map = {\n            'download': DownloadState(self.transformer),\n            'pause': PauseState(self.transformer),\n            'handle_delete': DeleteState(self.transformer),\n        }\n\n    def handle_click(self):\n        self.state_map[self.transformer.get_state()].click()\n\n    def handle_delete(self):\n        self.state_map[self.transformer.get_state()].delete()\n\n\nif __name__ == '__main__':\n    d = Download()\n    d.handle_click()\n    d.handle_click()\n    d.handle_delete()\n    d.handle_click()\n    d.handle_delete()\n    d.handle_click()\n    d.handle_click()\n")])]),e._v(" "),t("h2",{attrs:{id:"使用-es6-实现"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用-es6-实现","aria-hidden":"true"}},[e._v("#")]),e._v(" 使用 es6 实现")]),e._v(" "),t("p",[e._v("在 JavaScript 中，可以直接用 JSON 对象来代替状态类。")]),e._v(" "),t("p",[e._v("下面代码展示的就是 FSM（有限状态机）里面有 3 种状态：download、pause、deleted。 控制状态转化的代码也在其中。")]),e._v(" "),t("p",[e._v("DownLoad 类就是，常说的 Context 对象，它的行为会随着状态的改变而改变。")]),e._v(" "),t("pre",[t("code",[e._v("const FSM = (() => {\n\n        let state = 'download';\n\n        return {\n            download: {\n                click: () => {\n                    console.log('任务已经暂停');\n                    state = 'pause';\n                },\n                delete: () => {\n                    console.log('下载中,请先暂停再删除');\n                },\n            },\n            pause: {\n                click: () => {\n                    console.log('任务继续下载');\n                    state = 'download'\n                },\n                delete: () => {\n                    console.log('任务删除成功');\n                    state = 'delete';\n                }\n            },\n            delete: {\n                click: () => {\n                    console.log('任务已经被删除了，点击无效');\n                },\n                delete: () => {\n                    console.log('无法删除，任务已经被删除了');\n                }\n            },\n            getState: () => {\n                return state;\n            }\n        }\n    }\n)();\n\nclass Download {\n    constructor(fsm) {\n        this.transformer = fsm;\n    }\n    handleClick() {\n        this.transformer[this.transformer.getState()].click();\n    }\n    handleDelete() {\n        this.transformer[this.transformer.getState()].delete();\n    }\n}\n\nlet d = new Download(FSM);\nd.handleClick();\nd.handleClick();\nd.handleDelete();\nd.handleDelete();\nd.handleDelete();\nd.handleClick();\nd.handleDelete();\nd.handleClick();\n")])]),e._v(" "),t("blockquote",[t("p",[e._v("参考链接:")])]),e._v(" "),t("p",[t("a",{attrs:{href:"https://xin-tan.com/passages/2019-01-16-state-pattern/#_3-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0",target:"_blank",rel:"noopener noreferrer"}},[e._v("设计模式-状态模式"),t("OutboundLink")],1)])])},[],!1,null,null,null);n.default=l.exports}}]);